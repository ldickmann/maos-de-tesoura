import{_ as x,a as i,e,t as r,q as m,v as w,m as h,w as V,j as $,o as n,g as O,u as z,r as b,c as B,h as j,l,F as C,i as N,x as y,y as k,b as v,z as q,f as W,A as G,p as J,B as K}from"./index-DxEZSBr8.js";import{L as Q}from"./LoadingSpinner-CgczMA_0.js";const X={class:"error-container"},Y={class:"error-title"},Z={class:"error-message"},ee={class:"error-actions"},se={__name:"ErrorMessage",props:{title:{type:String,default:"Ops! Algo deu errado"},message:{type:String,required:!0},showRetry:{type:Boolean,default:!0},showBackHome:{type:Boolean,default:!1}},emits:["retry"],setup(f){return(o,u)=>{const S=$("router-link");return n(),i("div",X,[u[3]||(u[3]=e("div",{class:"error-icon"},[e("i",{class:"fas fa-exclamation-triangle"})],-1)),e("h3",Y,r(f.title),1),e("p",Z,r(f.message),1),e("div",ee,[f.showRetry?(n(),i("button",{key:0,class:"btn btn-primary",onClick:u[0]||(u[0]=p=>o.$emit("retry"))},u[1]||(u[1]=[e("i",{class:"fas fa-redo"},null,-1),h(" Tentar Novamente ")]))):m("",!0),f.showBackHome?(n(),w(S,{key:1,to:"/",class:"btn btn-secondary"},{default:V(()=>u[2]||(u[2]=[e("i",{class:"fas fa-home"},null,-1),h(" Voltar ao Início ")])),_:1})):m("",!0)])])}}},oe=x(se,[["__scopeId","data-v-440ca7f5"]]),te={class:"booking-page"},le={key:2,class:"booking-container"},ne={key:0,class:"booking-flow"},ae={class:"step"},ie={class:"service-summary"},re={class:"service-description"},de={class:"service-duration"},ue={class:"service-price"},me={class:"step"},ce={class:"professional-selection"},ve=["onClick"],fe={key:0,class:"pro-avatar"},pe=["src","alt"],ge={class:"pro-name"},ye={key:0,class:"error-message"},ke={key:0,class:"step"},_e={class:"date-section"},be=["min"],he={key:0,class:"error-message"},Se={key:0,class:"time-section"},Pe={class:"time-selection"},we=["onClick"],De={key:0,class:"error-message"},Te={key:1,class:"no-times"},Ee={key:1,class:"step"},Be={class:"form-group"},Ce={key:0,class:"error-message"},Ne={class:"form-group"},xe={key:0,class:"error-message"},Ve={class:"form-group"},$e={key:0,class:"error-message"},Ae={class:"form-group"},Re={key:2,class:"step"},Fe={class:"confirmation-summary"},He={class:"summary-grid"},Ie={class:"summary-item"},Le={class:"summary-item"},Me={class:"summary-item"},Ue={class:"summary-item"},Oe={class:"summary-item"},ze={class:"summary-item"},je={class:"summary-item"},qe={class:"summary-item total"},We=["disabled"],Ge={key:1,class:"no-service"},Je={class:"no-service-content"},Ke={__name:"BookingView",setup(f){const o=O(),u=z(),S=J(),p=b(!1),g=b(null),c=b(""),t=b({}),A=B(()=>new Date().toISOString().split("T")[0]),R=B(()=>o.getAvailableProfessionals()),F=d=>{o.setProfessional(d),c.value="",o.setDate(null),o.setTime(null),t.value.professional&&delete t.value.professional},H=()=>{o.setDate(c.value),o.setTime(null),t.value.date&&delete t.value.date},I=d=>{o.setTime(d),t.value.time&&delete t.value.time},D=()=>c.value?o.getAvailableTimesForDate(c.value):[],L=d=>{const s=d.target.value,_=G(s);o.clientPhone=_,t.value.clientPhone&&_.length>10&&delete t.value.clientPhone},T=d=>d?new Date(d+"T00:00:00").toLocaleDateString("pt-BR",{weekday:"long",year:"numeric",month:"long",day:"numeric"}):"",M=()=>{const d=K(o.bookingData);if(!d.isValid){t.value=d.errors,u.showError("Por favor, corrija os erros no formulário");return}t.value={},E()},E=async()=>{try{p.value=!0,await new Promise(d=>setTimeout(d,2e3)),u.showSuccess(`Agendamento confirmado para ${T(o.selectedDate)} às ${o.selectedTime}!`,{duration:8e3}),o.resetBooking(),S.push("/")}catch(d){u.showError("Erro ao confirmar agendamento. Tente novamente."),g.value="Ocorreu um erro ao confirmar seu agendamento. Por favor, tente novamente.",console.error("Booking error:",d)}finally{p.value=!1}},U=()=>{g.value=null};return j(()=>{o.selectedService||u.showWarning("Selecione um serviço antes de agendar")}),window.addEventListener("error",d=>{d.message&&d.message.includes("Failed to fetch dynamically imported module")&&(g.value="Não foi possível carregar alguns recursos da página. Por favor, tente novamente mais tarde.",u.showError("Erro ao carregar módulos da aplicação"))},!0),(d,s)=>{const _=$("router-link");return n(),i("div",te,[p.value?(n(),w(Q,{key:0,message:"Processando agendamento..."})):g.value?(n(),w(oe,{key:1,message:g.value,onRetry:U},null,8,["message"])):(n(),i("div",le,[s[30]||(s[30]=e("h1",null,"Agende seu Horário",-1)),s[31]||(s[31]=e("p",{class:"subtitle"},"Siga os passos abaixo para garantir o seu horário conosco.",-1)),l(o).selectedService?(n(),i("div",ne,[e("div",ae,[s[5]||(s[5]=e("h2",null,"1. Serviço Selecionado",-1)),e("div",ie,[e("div",null,[e("h3",null,r(l(o).selectedService.name),1),e("p",re,r(l(o).selectedService.description),1),e("p",de," Duração: "+r(l(o).selectedService.duration)+" min ",1)]),e("p",ue,"R$ "+r(l(o).selectedService.price.toFixed(2)),1)])]),e("div",me,[s[6]||(s[6]=e("h2",null,"2. Escolha o Profissional",-1)),e("div",ce,[(n(!0),i(C,null,N(R.value,a=>{var P;return n(),i("div",{key:a.id,class:v(["professional-card",{selected:((P=l(o).selectedProfessional)==null?void 0:P.id)===a.id,error:t.value.professional}]),onClick:Qe=>F(a)},[a.avatar?(n(),i("div",fe,[e("img",{src:a.avatar,alt:a.name},null,8,pe)])):m("",!0),e("p",ge,r(a.name),1)],10,ve)}),128))]),t.value.professional?(n(),i("div",ye,r(t.value.professional),1)):m("",!0)]),l(o).selectedProfessional?(n(),i("div",ke,[s[9]||(s[9]=e("h2",null,"3. Escolha a Data e Hora",-1)),e("div",_e,[s[7]||(s[7]=e("label",{for:"booking-date",class:"form-label"},"Data:",-1)),y(e("input",{id:"booking-date",type:"date","onUpdate:modelValue":s[0]||(s[0]=a=>c.value=a),onChange:H,class:v(["date-input",{error:t.value.date}]),min:A.value},null,42,be),[[k,c.value]]),t.value.date?(n(),i("div",he,r(t.value.date),1)):m("",!0)]),c.value?(n(),i("div",Se,[s[8]||(s[8]=e("label",{class:"form-label"},"Horário disponível:",-1)),e("div",Pe,[(n(!0),i(C,null,N(D(),a=>(n(),i("div",{key:a,class:v(["time-slot",{selected:l(o).selectedTime===a,error:t.value.time}]),onClick:P=>I(a)},r(a),11,we))),128))]),t.value.time?(n(),i("div",De,r(t.value.time),1)):m("",!0),D().length===0?(n(),i("div",Te," Não há horários disponíveis para esta data. ")):m("",!0)])):m("",!0)])):m("",!0),l(o).selectedTime?(n(),i("div",Ee,[s[14]||(s[14]=e("h2",null,"4. Seus Dados",-1)),e("form",{onSubmit:q(M,["prevent"]),class:"client-form"},[e("div",Be,[s[10]||(s[10]=e("label",{for:"client-name",class:"form-label"},"Nome Completo:",-1)),y(e("input",{id:"client-name",type:"text","onUpdate:modelValue":s[1]||(s[1]=a=>l(o).clientName=a),class:v(["form-input",{error:t.value.clientName}]),placeholder:"Digite seu nome completo"},null,2),[[k,l(o).clientName]]),t.value.clientName?(n(),i("div",Ce,r(t.value.clientName),1)):m("",!0)]),e("div",Ne,[s[11]||(s[11]=e("label",{for:"client-phone",class:"form-label"},"Telefone:",-1)),y(e("input",{id:"client-phone",type:"tel","onUpdate:modelValue":s[2]||(s[2]=a=>l(o).clientPhone=a),onInput:L,class:v(["form-input",{error:t.value.clientPhone}]),placeholder:"(11) 99999-9999",maxlength:"15"},null,34),[[k,l(o).clientPhone]]),t.value.clientPhone?(n(),i("div",xe,r(t.value.clientPhone),1)):m("",!0)]),e("div",Ve,[s[12]||(s[12]=e("label",{for:"client-email",class:"form-label"},"Email:",-1)),y(e("input",{id:"client-email",type:"email","onUpdate:modelValue":s[3]||(s[3]=a=>l(o).clientEmail=a),class:v(["form-input",{error:t.value.clientEmail}]),placeholder:"seu.email@exemplo.com"},null,2),[[k,l(o).clientEmail]]),t.value.clientEmail?(n(),i("div",$e,r(t.value.clientEmail),1)):m("",!0)]),e("div",Ae,[s[13]||(s[13]=e("label",{for:"client-notes",class:"form-label"},"Observações (opcional):",-1)),y(e("textarea",{id:"client-notes","onUpdate:modelValue":s[4]||(s[4]=a=>l(o).clientNotes=a),class:"form-textarea",placeholder:"Alguma preferência ou observação especial?",rows:"3"},null,512),[[k,l(o).clientNotes]])])],32)])):m("",!0),l(o).isComplete?(n(),i("div",Re,[s[25]||(s[25]=e("h2",null,"5. Confirmação",-1)),e("div",Fe,[s[23]||(s[23]=e("h3",null,"Resumo do Agendamento",-1)),e("div",He,[e("div",Ie,[s[15]||(s[15]=e("strong",null,"Serviço:",-1)),e("span",null,r(l(o).selectedService.name),1)]),e("div",Le,[s[16]||(s[16]=e("strong",null,"Profissional:",-1)),e("span",null,r(l(o).selectedProfessional.name),1)]),e("div",Me,[s[17]||(s[17]=e("strong",null,"Data:",-1)),e("span",null,r(T(l(o).selectedDate)),1)]),e("div",Ue,[s[18]||(s[18]=e("strong",null,"Horário:",-1)),e("span",null,r(l(o).selectedTime),1)]),e("div",Oe,[s[19]||(s[19]=e("strong",null,"Duração:",-1)),e("span",null,r(l(o).selectedService.duration)+" minutos",1)]),e("div",ze,[s[20]||(s[20]=e("strong",null,"Cliente:",-1)),e("span",null,r(l(o).clientName),1)]),e("div",je,[s[21]||(s[21]=e("strong",null,"Telefone:",-1)),e("span",null,r(l(o).clientPhone),1)]),e("div",qe,[s[22]||(s[22]=e("strong",null,"Total:",-1)),e("span",null,"R$ "+r(l(o).selectedService.price.toFixed(2)),1)])])]),e("button",{onClick:E,class:"confirm-button",disabled:p.value},s[24]||(s[24]=[e("i",{class:"fas fa-check"},null,-1),h(" Confirmar Agendamento ")]),8,We)])):m("",!0)])):(n(),i("div",Ge,[e("div",Je,[s[27]||(s[27]=e("i",{class:"fas fa-calendar-times"},null,-1)),s[28]||(s[28]=e("h2",null,"Nenhum serviço selecionado",-1)),s[29]||(s[29]=e("p",null,"Para fazer um agendamento, você precisa primeiro escolher um serviço.",-1)),W(_,{to:"/servicos",class:"btn-primary"},{default:V(()=>s[26]||(s[26]=[e("i",{class:"fas fa-cut"},null,-1),h(" Ver Serviços Disponíveis ")])),_:1})])]))]))])}}},Ze=x(Ke,[["__scopeId","data-v-42ad3a5c"]]);export{Ze as default};
